var weapon_blueprint = {
	starter_sword: {
		name: "Cutter Blade",
		player:true,
		nodes: [
			[4, 29],
			[37, 30],
			[37, 42],
			[17, 44]
		],
		dmg: 100,
		offsetX: 0,
		offsetY: 0,
		spin: 2,
		range: 1,
		tier: 1
	},
	spear1: {
		name: "Arrow",
		player:true,
		nodes: [
			[4, 34],
			[50, 34],
			[50, 44],
			[4, 44]
		],
		dmg: 120,
		offsetX: 0,
		offsetY: 0,
		spin: 2,
		range: 1,
		tier: 1
	},
	kitchen_knife: {
		name: "Kitchen Knife",
		player:true,
		nodes: [
			[4, 34],
			[50, 34],
			[50, 44],
			[4, 44]
		],
		dmg: 130,
		offsetX: 0,
		offsetY: 0,
		spin: 1.7,
		range: 1
	},
	spear2: {
		name: "Assasin's Dagger",
		player:true,
		nodes: [
			[4, 34],
			[50, 34],
			[50, 44],
			[4, 44]
		],
		dmg: 150,
		offsetX: 0,
		offsetY: 0,
		spin: 2.6,
		range: 1,
		tier: 2
	},
	bullet: {
		name: "Bullet Stab",
		player:true,
		nodes: [
			[4, 34],
			[50, 34],
			[50, 44],
			[4, 44]
		],
		dmg: 130,
		offsetX: 0,
		offsetY: 0,
		spin: 4,
		range: 1,
		tier: 3
	},
	banana: {
		name: "Banana Stab",
		player:true,
		nodes: [
			[4, 34],
			[50, 34],
			[50, 44],
			[4, 44]
		],
		dmg: 180,
		offsetX: 0,
		offsetY: 0,
		spin: 1,
		range: 1,
		tier: 2
	},



	short_dagger: {
		name: "Backstabber",
		player:true,
		nodes: [
			[20, 6],
			[52, 6],
			[36, 65]
		],
		dmg: 80,
		offsetX: 0,
		offsetY: 0,
		spin: 2,
		range: 2,
		tier: 2
	},
	katana: {
		name: "Katana",
		player:true,
		nodes: [
			[20, 6],
			[52, 6],
			[36, 65]
		],
		dmg: 50,
		offsetX: 0,
		offsetY: -30,
		spin: 3,
		range: 3,
		tier: 3
	},
	cool1: {
		name: "Assasin's Spear",
		player:true,
		nodes: [
			[20, 6],
			[52, 6],
			[36, 65]
		],
		dmg: 90,
		offsetX: 0,
		offsetY: 0,
		spin: 2.4,
		range: 2,
		tier: 3
	},
	pixel1: {
		name: "Pixeled Knife",
		player:true,
		nodes: [
			[20, 6],
			[52, 6],
			[36, 65]
		],
		dmg: 70,
		offsetX: 0,
		offsetY: 0,
		spin: 1.8,
		range: 2,
		tier: 1
	},
	diaknife: {
		name: "Dia Knife",
		player:true,
		nodes: [
			[20, 6],
			[52, 6],
			[36, 65]
		],
		dmg: 60,
		offsetX: 0,
		offsetY: 0,
		spin: 1.2,
		range: 2,
		tier: 1
	},
	carrotknife: {
		name: "Carrot Cutter",
		player:true,
		nodes: [
			[20, 6],
			[52, 6],
			[36, 65]
		],
		dmg: 70,
		offsetX: 0,
		offsetY: 0,
		spin: 2.5,
		range: 3
	},




	longsword: {
		name: "longsword",
		nodes: [
			[64, 0],
			[84, 35],
			[64, 128],
			[44, 35]
		],
		dmg: 30,
		offsetX: 0,
		offsetY: -10,
		spin: 2,
	},
	broom: {
		name: "broom",
		nodes: [
			[80, 12],
			[110, 86],
			[47, 116],
			[17, 79]
		],
		dmg: 1000,
		offsetX: 20,
		offsetY: 0,
		spin: 1,
	},
	speedsword: {
		name: "speedsword",
		nodes: [
			[50, 9],
			[70, 40],
			[30, 40],
			[44, 35]
		],
		dmg: 50,
		offsetX: 0,
		offsetY: -10,
		spin: 7,
	},
	shield: {
		name: "shield",
		nodes: [
			[5, 4],
			[77, 6],
			[77, 14],
			[6, 15]
		],
		dmg: 80,
		offsetX: 0,
		offsetY: -33,
		spin: 2,
	},
	pendulum: {
		name: "pendulum",
		nodes: [
			[21, 3],
			[48, 23],
			[28, 49],
			[2, 30]
		],
		dmg: 50,
		offsetX: 0,
		offsetY: -140,
		spin: 2,
	},
	slow_pendulum: {
		name: "slow_pendulum",
		nodes: [
			[21, 3],
			[48, 23],
			[28, 49],
			[2, 30]
		],
		dmg: 60,
		offsetX: 0,
		offsetY: -140,
		spin: 2,
	},
	long_pendulum: {
		name: "long_pendulum",
		nodes: [
			[21, 3],
			[48, 23],
			[28, 49],
			[2, 30]
		],
		dmg: 80,
		offsetX: 0,
		offsetY: -140,
		spin: 2,
	},
	butterfly: {
		name: "butterfly",
		nodes: [
			[65, 10],
			[85, 10],
			[100, 110],
			[80, 150],
			[60, 157],
			[53, 68]
		],
		dmg: 1000,
		offsetX: 0,
		offsetY: -10,
		spin: 8,
	},
	lol_fist: {
		name: "lol_fist",
		nodes: [
			[15, 22],
			[73, 33],
			[74, 54],
			[27, 53],
			[11, 44]
		],
		dmg: 80,
		offsetX: 0,
		offsetY: -20,
		spin: 2,
	},
	superfast: {
		name: "superfast",
		nodes: [
			[6, 11],
			[42, 11],
			[44, 16],
			[12, 16]
		],
		dmg: 30,
		offsetX: 0,
		offsetY: 0,
		spin: 30,
	},
	tiny_fast_dagger: {
		name: "tiny_fast_dagger",
		nodes: [
			[16, 5],
			[34, 5],
			[25, 50]
		],
		dmg: 40,
		offsetX: 0,
		offsetY: 0,
		spin: 5,
	},
	wearable: {
		name: "wearable",
		nodes: [
			[9, 9],
			[31, 9],
			[31, 31],
			[9, 31]
		],
		dmg: 30,
		offsetX: 0,
		offsetY: 0,
		spin: 5,
	}
}

var weapons = {

}

var weapon_manager = {
	init: function() {
		for (let weapon_id in weapon_blueprint) {
			this.init_weapon(weapon_id);
		}
	},
	init_weapon: function(weapon_id) {
		let asset = `w_${weapon_id}`;
		let {nodes, offsetX, offsetY, spin, dmg} = weapon_blueprint[weapon_id];

		let fn = function(turn_dir, _init_r, overrideOffsetY, overrideSpin) {
			let init_r = weapon_manager.angle(_init_r);
			var final_spin;
			if (turn_dir != null) {
				final_spin = spin * turn_dir;
			} else {
				final_spin = spin;
			}
			if (overrideOffsetY != null) {
				offsetY = overrideOffsetY;
			}

			if (overrideSpin != null) {
				final_spin = overrideSpin;
			}
			
			return new Blade(asset, nodes, offsetX, offsetY, final_spin, init_r, dmg);
		};

		weapons[weapon_id] = fn;

		// delete weapon_blueprint[weapon_id].nodes;
		// delete weapon_blueprint[weapon_id].offsetX;
		// delete weapon_blueprint[weapon_id].offsetY;
	},
	angle: function(angle) {
		if (angle == null) {
			return Math.PI*2*Math.random();
		} else {
			return angle;
		}
		
	}
}